<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tauri API Test</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .test-result { margin: 10px 0; padding: 10px; border-radius: 5px; }
    .success { background-color: #d4edda; border: 1px solid #c3e6cb; }
    .error { background-color: #f8d7da; border: 1px solid #f5c6cb; }
    .info { background-color: #d1ecf1; border: 1px solid #bee5eb; }
    button { margin: 5px; padding: 10px 15px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Tauri API 测试页面</h1>
  
  <div id="results"></div>
  
  <div style="margin-top: 20px;">
    <button onclick="testEnvironment()">测试环境</button>
    <button onclick="testGetVersion()">测试版本</button>
    <button onclick="testSkuList()">测试 SKU 列表</button>
    <button onclick="testCategoryList()">测试分类列表</button>
    <button onclick="testCustomerList()">测试客户列表</button>
    <button onclick="testOrderList()">测试订单列表</button>
  </div>

  <script>
    function log(message, type = 'info') {
      const results = document.getElementById('results');
      const div = document.createElement('div');
      div.className = `test-result ${type}`;
      div.innerHTML = message;
      results.appendChild(div);
    }

    function testEnvironment() {
      log(`<strong>环境测试：</strong><br>
           window.__TAURI__: ${!!window.__TAURI__}<br>
           window.__TAURI__?.core: ${!!window.__TAURI__?.core}<br>
           window.__TAURI__?.core?.invoke: ${!!window.__TAURI__?.core?.invoke}`, 'info');
    }

    async function testGetVersion() {
      try {
        if (!window.__TAURI__?.core?.invoke) {
          log('Tauri API 不可用', 'error');
          return;
        }
        const version = await window.__TAURI__.core.invoke('get_version');
        log(`<strong>版本测试成功：</strong> ${version}`, 'success');
      } catch (error) {
        log(`<strong>版本测试失败：</strong> ${error.message}`, 'error');
      }
    }

    async function testSkuList() {
      try {
        if (!window.__TAURI__?.core?.invoke) {
          log('Tauri API 不可用', 'error');
          return;
        }
        const skus = await window.__TAURI__.core.invoke('sku_list');
        log(`<strong>SKU 列表测试成功：</strong> 获取到 ${skus.length} 个 SKU`, 'success');
      } catch (error) {
        log(`<strong>SKU 列表测试失败：</strong> ${error.message}`, 'error');
      }
    }

    async function testCategoryList() {
      try {
        if (!window.__TAURI__?.core?.invoke) {
          log('Tauri API 不可用', 'error');
          return;
        }
        const categories = await window.__TAURI__.core.invoke('category_list');
        log(`<strong>分类列表测试成功：</strong> 获取到 ${categories.length} 个分类`, 'success');
      } catch (error) {
        log(`<strong>分类列表测试失败：</strong> ${error.message}`, 'error');
      }
    }

    async function testCustomerList() {
      try {
        if (!window.__TAURI__?.core?.invoke) {
          log('Tauri API 不可用', 'error');
          return;
        }
        const customers = await window.__TAURI__.core.invoke('customer_list');
        log(`<strong>客户列表测试成功：</strong> 获取到 ${customers.length} 个客户`, 'success');
      } catch (error) {
        log(`<strong>客户列表测试失败：</strong> ${error.message}`, 'error');
      }
    }

    async function testOrderList() {
      try {
        if (!window.__TAURI__?.core?.invoke) {
          log('Tauri API 不可用', 'error');
          return;
        }
        const orders = await window.__TAURI__.core.invoke('order_list');
        log(`<strong>订单列表测试成功：</strong> 获取到 ${orders.length} 个订单`, 'success');
      } catch (error) {
        log(`<strong>订单列表测试失败：</strong> ${error.message}`, 'error');
      }
    }

    window.onload = function() {
      log('页面加载完成，点击按钮开始测试', 'info');
      testEnvironment();
    };
  </script>
</body>
</html>